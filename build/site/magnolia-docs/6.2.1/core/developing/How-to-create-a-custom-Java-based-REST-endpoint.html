<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>How to create a custom Java-based REST endpoint - Magnolia 6.2 :: Magnolia CMS Docs</title>
    <link rel="canonical" href="http://localhost:9096/magnolia-docs/6.2.1/core/developing/How-to-create-a-custom-Java-based-REST-endpoint.html">
    <meta name="generator" content="Antora 2.3.3">
<link rel="stylesheet" href="../../../../_/css/site.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
    integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
        <script src="https://use.fontawesome.com/ecc89e1666.js"></script>
    <script
        src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
        crossorigin="anonymous">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item magnolia-logo" href="../../../../index.html">
      </a>
      <input type="search" placeholder="Search the docs" name="search" id="searchBar">


      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
      
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item disabled" href="../../../../magnolia-docs/6.2/core/index.html">Core</a>
        <a class="navbar-item disabled" href="../../../../magnolia-docs/6.2/cloud/index.html">Cloud</a>
        <a class="navbar-item disabled" href="../../../../magnolia-general/faqs.html">FAQs</a>
        <a href="https://www.magnolia-cms.com/get-started.html" class="navbar-item" target="_blank"><button class="magnolia-btn">Try Magnolia</button></a>
      </div>
    </div>
  </nav>
</header>
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">6.2.1</button>
  <div class="version-menu">
    <a class="version is-current" href="How-to-create-a-custom-Java-based-REST-endpoint.html">6.2.1</a>
    <a class="version is-missing" href="../../../6.2/index.html">6.2</a>
  </div>
</div>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Magnolia Documentation</a></li>
    <li><a href="How-to-create-a-custom-Java-based-REST-endpoint.html">How to create a custom Java-based REST endpoint - Magnolia 6.2</a></li>
  </ul>
</nav>
</div>
<div class="body">
<div class="nav-container" data-component="magnolia-docs" data-version="6.2.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../rn/release-notes.html">Release notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Get Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/hello-magnolia.html">Hello Magnolia</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cloud/getting-started/hello-cloud.html">Hello Magnolia Cloud</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Dump</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cloud/Magnolia-Cloud.html">Cloud</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../administration/Administration.html">Administration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Developing.html">Developing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../templating/Templating.html">Templating</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../modules/Modules.html">Modules</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../authoring/Authoring.html">Authoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connector-packs/Connector_Packs.html">Connector Packs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../apps/Apps.html">Apps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cli/Magnolia-CLI.html">Command Line Interface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../special-features/Special-Features.html">Special Features</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../support/Support.html">Need Support?</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
  </div>
</div>
    </div>
  </aside>
</div>
<main>
<article class="doc">
    <h1 class="page">How to create a custom Java-based REST endpoint - Magnolia 6.2</h1>
    <div id="preamble">
<div class="sectionbody">
<div id="ht-loader" class="paragraph">
<p>This content cannot be displayed without JavaScript.<br>
Please enable JavaScript and reload the page.</p>
</div>
<div class="paragraph">
<p><a href="" class="bare"></a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_docs62"><a class="anchor" href="#_docs62"></a><span class="ht-logo-label">DOCS62</span> <span class="image"><img src="../../_images/DOCS62.png" alt="image"></span></h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="Developing.html" class="bare">Developing.html</a></p>
</div>
<div class="sect2">
<h3 id="_magnolia_6_2_documentation"><a class="anchor" href="#_magnolia_6_2_documentation"></a>Magnolia 6.2 documentation</h3>
<div id="ht-sidebar-dragbar" class="paragraph">
<p><span class="drag-handle-1"> [.drag-handle-2]</span> [.drag-handle-3]##</p>
</div>
<div id="ht-breadcrumb" class="ulist">
<ul>
<li>
<p><a href="Developing.html">Magnolia 6.2 documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="src-196596420"><a class="anchor" href="#src-196596420"></a>How to create a custom Java-based REST endpoint</h2>
<div class="sectionbody">
<div id="main-content" class="paragraph">
<p>Related topics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.magnolia-cms.com/display/DOCS62/Getting+started+with+REST">Getting
started with REST</a></p>
</li>
<li>
<p><a href="https://wiki.magnolia-cms.com/display/DOCS62/REST+module">REST module</a></p>
</li>
<li>
<p><a href="How-to-get-content-as-JSON---an-overview.html">How to get content
as JSON - an overview</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This page provides guidelines and best practice recommendations on how
to create a custom Java-based REST endpoint with Magnolia.</p>
</div>
<div class="paragraph">
<p>Java-based custom REST endpoints give access to the full power of Java
and provide a high level of flexibility and configurability. REST
endpoints in Magnolia also allow fine-grained security.</p>
</div>
<div class="paragraph">
<p>If you so require, Magnolia can integrate
<a href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-using-swagger-tools">Swagger
tools</a> directly within the Admin UI to facilitate the development and
testing of your endpoints.</p>
</div>
<div class="paragraph">
<p>Endpoints can be used for many purposes, from triggering a third party
service to implementing a custom JSON provider. However, there are also
other possibilities to
<a href="How-to-get-content-as-JSON---an-overview.html">get Magnolia content
as JSON</a>.</p>
</div>
<div class="paragraph">
<p>In this page, we assume that you know Java and the basics of Maven or
another similar dependency management tool.</p>
</div>
<div class="sect2">
<h3 id="src-196596420_safe-id-SG93dG9jcmVhdGVhY3VzdG9tSmF2YS1iYXNlZFJFU1RlbmRwb2ludC1XaGF0aXNhTWFnbm9saWFSRVNUZW5kcG9pbnQ_"><a class="anchor" href="#src-196596420_safe-id-SG93dG9jcmVhdGVhY3VzdG9tSmF2YS1iYXNlZFJFU1RlbmRwb2ludC1XaGF0aXNhTWFnbm9saWFSRVNUZW5kcG9pbnQ_"></a>What is a Magnolia REST endpoint?</h3>
<div class="paragraph">
<p>A REST endpoint is a resource located on a server, in our case on a
Magnolia instance, which can be accessed with a RESTful URL.</p>
</div>
<div class="paragraph">
<p>A Java endpoint makes use of the
<a href="https://en.wikipedia.org/wiki/Java_API_for_RESTful_Web_Services">Java API
for RESTful Web Services</a> (JAX-RS). The endpoint exposes public methods
accessible via distinct URLs. A public method is accessed with a request
and produces a response.</p>
</div>
<div class="paragraph">
<p>Magnolia REST endpoints are JAX-RS endpoints.</p>
</div>
<div class="sect3">
<h4 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-RESTbasepathandRestDispatcherServlet"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-RESTbasepathandRestDispatcherServlet"></a>REST base path and RestDispatcherServlet</h4>
<div class="paragraph">
<p>The base path for every Magnolia REST resource is <code>/&lt;context&gt;/.rest</code>,
where &lt;context&gt; is either the name of the webapp or <code>/</code> if the webapp is
served from the root context. For details about specific paths of
specific REST resources, see
<a href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-understanding-path">Understanding
<code>@Path</code></a> below.</p>
</div>
<div class="paragraph">
<p>All requests to <code>/&lt;context&gt;/.rest*</code> are handled by the
RestDispatcherServlet, which is installed and configured by the
<a href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-magnolia-rest-integration"><code>magnolia-rest-integration</code>
module</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="src-196596420_safe-id-SG93dG9jcmVhdGVhY3VzdG9tSmF2YS1iYXNlZFJFU1RlbmRwb2ludC1XaGF0ZG9lbmRwb2ludHNkbz8"><a class="anchor" href="#src-196596420_safe-id-SG93dG9jcmVhdGVhY3VzdG9tSmF2YS1iYXNlZFJFU1RlbmRwb2ludC1XaGF0ZG9lbmRwb2ludHNkbz8"></a>What do endpoints do?</h4>
<div class="paragraph">
<p>An endpoint can have several methods accomplishing completely different
tasks. Basically endpoints can do anything that is possible with Java.</p>
</div>
<div class="paragraph">
<p>Each publicly exposed method representing a REST resource must produce a
response that contains at least some response headers (the minimum is a
proper <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">HTTP
response code</a>). Both the request and response may or may not contain a
"payload" (JSON or XML) wrapped in the request or response body.</p>
</div>
<div class="paragraph">
<p>An endpoint should implement at least one method that can be accessed by
its specific path with one of the standard HTTP methods: <code>GET</code>, <code>PUT</code>,
<code>POST</code> or <code>DELETE</code>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/images/download/attachments/196596420/generic-endpoit-drawing.png" alt="images/download/attachments/196596420/generic-endpoit-drawing.png"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-DataAPIendpoints"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-DataAPIendpoints"></a>Data API endpoints</h4>
<div class="paragraph">
<p>A typical use case for an endpoint is a data API, which can read,
create, update or delete content. A data API endpoint must implement at
least one method, such as a <code>GET</code> method to read data.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/images/download/attachments/196596420/data-API-endpoint.png" alt="images/download/attachments/196596420/data-API-endpoint.png"></span></p>
</div>
<div class="paragraph">
<p>Typically, methods for data interaction are called with these HTTP
methods:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data interaction function</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delete
data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PUT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DELETE</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request has payload</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Response has payload</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">maybe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">maybe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Magnolia provides default endpoints to read, create, update and delete
nodes and properties of JCR workspaces. For details about the Magnolia
default JCR content API, read the section about the
<a href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-magnolia-rest-services"><code>magnolia-rest-services</code>
module</a> below or have a look at the <a href="REST-API.html">REST API</a> page.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="src-196596420_safe-id-SG93dG9jcmVhdGVhY3VzdG9tSmF2YS1iYXNlZFJFU1RlbmRwb2ludC1KYXZhLE1hdmVuYW5kcGFja2FnZW5hbWVz"><a class="anchor" href="#src-196596420_safe-id-SG93dG9jcmVhdGVhY3VzdG9tSmF2YS1iYXNlZFJFU1RlbmRwb2ludC1KYXZhLE1hdmVuYW5kcGFja2FnZW5hbWVz"></a>Java, Maven and package names</h3>
<div class="paragraph">
<p>Java classes typically are wrapped in modules. When the Java classes of
your endpoint are part of a (Maven) module, you can add the module to
your <a href="Bundles-and-webapps.html">bundle or webapp</a> as a .jar file or
manage the dependency with Maven in the .pom file of the webapp.</p>
</div>
<div class="paragraph">
<p>Best practice</p>
</div>
<div class="paragraph">
<p>Wrap your Java REST endpoint within a Magnolia Maven module.</p>
</div>
<div class="sect3">
<h4 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-CreatingaMagnoliaMavenmodulewithaMavenarchetype"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-CreatingaMagnoliaMavenmodulewithaMavenarchetype"></a>Creating a Magnolia Maven module with a Maven archetype</h4>
<div class="paragraph">
<p>Use the Magnolia Maven archetype to create a new Magnolia Maven module
that will host your Java REST endpoint.</p>
</div>
<div class="paragraph">
<p>[.admonition-icon .confluence-information-macro-icon]##</p>
</div>
<div class="paragraph">
<p>If you are not familiar with the Maven archetype plugin, please read
<a href="How-to-use-Magnolia-Maven-archetypes.html#src-196596447_HowtouseMagnoliaMavenarchetypes-TheArchetypeplugin">How
to use Magnolia Maven archetypes: The archetype plugin</a>.</p>
</div>
<div class="paragraph">
<p>Here is the archetype command call:</p>
</div>
<div class="paragraph">
<p><code>mvn archetype:generate -DarchetypeGroupId=info.magnolia.maven.archetypes -DarchetypeArtifactId=magnolia-module-archetype -DarchetypeVersion=RELEASE</code></p>
</div>
<div class="paragraph">
<p>Notes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Always use the latest version of the archetype.</p>
</li>
<li>
<p>Provide meaningful values for the <code>groupId</code> and <code>artifactId</code>.</p>
</li>
<li>
<p>Provide the <code>magnolia-bundle-version</code> that fits your existing Magnolia
bundle(s) best. If you are not sure, use the latest released Magnolia
version: 6.2.1.</p>
</li>
<li>
<p><span class="image"><img src="../../_images/images/s/en_GB/8100/5084f018d64a97dc638ca9a178856f851ea353ff/<em>/images/icons/emoticons/information.svg" alt="images/s/en_GB/8100/5084f018d64a97dc638ca9a178856f851ea353ff/</em>/images/icons/emoticons/information.svg"></span>
The archetype creates a POM file which imports the
<code>magnolia-bundle-parent</code>. This parent manages the versions of Magnolia
modules you rely on.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>[<mark>src-196596420_HowtocreateacustomJava-basedRESTendpoint-java-package-name]</mark>#</p>
</div>
</div>
<div class="sect3">
<h4 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-Javapackagename"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-Javapackagename"></a>Java package name</h4>
<div class="paragraph">
<p>Best practice</p>
</div>
<div class="paragraph">
<p>Add the Java class, which represents the REST resource, to a package
with a name that allows versioning of the REST resource. Typically, the
last part of the package name should indicate the version.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>com.example.rest.service.v1.DemoEndpoint</p>
</div>
<div class="paragraph">
<p><code>package`</code> com.example.rest.service.v1;`</p>
</div>
<div class="paragraph">
<p><code>@Path(<code>"/demo/v1"</code>)</code></p>
</div>
<div class="paragraph">
<p><code>public<code> </code>class`</code> DemoEndpoint {`</p>
</div>
<div class="paragraph">
<p>`  <code>`/* more code to be added here later on */</code></p>
</div>
<div class="paragraph">
<p><code>}</code></p>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The package name is `com.example.rest.service.v1 `.</p>
</li>
<li>
<p>The class name is <code>DemoEndpoint</code>.</p>
</li>
<li>
<p>The fully qualified class name (fqcn) is
<code>com.example.rest.service.v1.DemoEndpoint</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want to raise the version of the endpoint later on, without
disabling the original version, create a package with a higher version
such as `com.example.rest.service.v2 `.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-MagnoliaRESTmodulesandrecommendeddependencies"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-MagnoliaRESTmodulesandrecommendeddependencies"></a>Magnolia REST modules and recommended dependencies</h3>
<div class="paragraph">
<p>We assume that you know the basics about how to manage dependencies, and
that you manage these dependencies with Maven.</p>
</div>
<div class="paragraph">
<p>The <a href="https://en.wikipedia.org/wiki/Java_API_for_RESTful_Web_Services">Java
API for RESTful Web Services - JAX-RS</a> is defined in the packages
<code>javax.ws.rs</code> and <code>javax.xml.bind</code>. These are interfaces and sufficient
for endpoint classes during compilation. However, on runtime, when the
REST resources are used, a webapp also requires implementations of the
these two mentioned packages. Magnolia uses
<a href="http://resteasy.jboss.org/">RESTeasy</a> for this purpose.</p>
</div>
<div class="paragraph">
<p>The dependencies (for both the interfaces and the implementations) are
managed by the <code>magnolia-rest-integration</code> module.</p>
</div>
<div class="paragraph">
<p>Best practice</p>
</div>
<div class="paragraph">
<p>Depend on the
<a href="https://wiki.magnolia-cms.com/display/DOCS62/REST+module">Magnolia REST
modules</a>. This ensures that you use the same versions of JAX-RS
interfaces and implementation libraries as Magnolia.</p>
</div>
<div class="paragraph">
<p>You should at least depend on the <code>magnolia-rest-integration</code> module.</p>
</div>
<div class="paragraph">
<p>Your module, which depends on Magnolia REST module(s), automatically
(transiently) inherits the dependencies from the Magnolia modules.</p>
</div>
<div class="paragraph">
<p>The Magnolia REST module contains three submodules.</p>
</div>
<div class="sect3">
<h4 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-magnolia-rest-modulesMagnoliaRESTmodules"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-magnolia-rest-modulesMagnoliaRESTmodules"></a><span id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-magnolia-rest-modules " class="confluence-anchor-link">#</span>#Magnolia REST modules</h4>
<div class="sect4">
<h5 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-magnolia-rest-integration"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-magnolia-rest-integration"></a>magnolia-rest-integration</h5>
<div class="paragraph">
<p>The REST Integration module installs the integration part of REST. The
module:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Manages the dependencies for the required JAX-RS libraries.</p>
</li>
<li>
<p>Monitors <code>/config/&lt;module-name&gt;/rest-endpoints</code> for any <a href="#">custom
endpoints</a> you want to register. The monitoring mechanism is the same as
used for observing registered dialogs, templates and apps.</p>
</li>
<li>
<p>Installs a special servlet <code>RestDispatcherServlet</code> which dispatches
requests to the individual endpoints registered in configuration.</p>
</li>
<li>
<p>Lets you define additional providers or
<a href="http://docs.jboss.org/resteasy/docs/3.0.6.Final/userguide/html_single/index.html#Content_Marshalling_Providers">marshallers</a>
(called `MessageBodyWorkers `in RESTeasy) you might need. The providers
are responsible for translating the return object into JSON/XML and
vice-versa.</p>
</li>
<li>
<p>Installs the default <code>rest</code> role that initially prevents access to
unauthorized requests.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Click here to expand to get the Maven dependency snippet</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;info.magnolia.rest&lt;/groupId&gt;
  &lt;artifactId&gt;magnolia-rest-integration&lt;/artifactId&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-magnolia-rest-services"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-magnolia-rest-services"></a>magnolia-rest-services</h5>
<div class="paragraph">
<p>The <code>magnolia-rest-services</code> module depends on the
<code>magnolia-rest-integration</code> module. Therefore it provides everything
explained in the preceding section.</p>
</div>
<div class="paragraph">
<p>In addition, it contains the Magnolia default REST endpoints
NodeEndpoint and PropertyEndpoint and the CommandEndpoint , which are
described on the <a href="REST-API.html">REST API</a> page.</p>
</div>
<div class="paragraph">
<p>This module also provides the RepositoryMarshaller , which
<a href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-Aboutmarshallinganddataconversion">you
can use</a> within your custom endpoint.</p>
</div>
<div class="paragraph">
<p>Click here to expand to get the Maven dependency snippet</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;info.magnolia.rest&lt;/groupId&gt;
  &lt;artifactId&gt;magnolia-rest-services&lt;/artifactId&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-magnolia-rest-content-delivery"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-magnolia-rest-content-delivery"></a>magnolia-rest-content-delivery</h5>
<div class="paragraph">
<p>This module provides the <a href="Delivery-endpoint-API.html">Delivery
endpoint</a>.</p>
</div>
<div class="paragraph">
<p>Click here to expand to get the Maven dependency snippet</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;info.magnolia.rest&lt;/groupId&gt;
  &lt;artifactId&gt;magnolia-rest-content-delivery&lt;/artifactId&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-magnolia-rest-tools"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-magnolia-rest-tools"></a>magnolia-rest-tools</h5>
<div class="paragraph">
<p>The REST Tools module integrates the <a href="https://swagger.io/tools/">swagger
tools</a> into the Admin UI. These tools ease the development and testing
of REST endpoints.</p>
</div>
<div class="paragraph">
<p>The module extends the <code>RestDispatcherServlet</code> with a custom, API-aware
servlet that can read API annotations from all available REST endpoints.
The servlet enables the endpoints in the Swagger API explorer. If you
write your own endpoint you need to add annotations in the code
yourself.</p>
</div>
<div class="paragraph">
<p>The module is used for development and testing purposes only.</p>
</div>
<div class="paragraph">
<p>Click here to expand to get the Maven dependency snippet</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;dependency&gt;
  &lt;groupId&gt;info.magnolia.rest&lt;/groupId&gt;
  &lt;artifactId&gt;magnolia-rest-tools&lt;/artifactId&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-MagnoliaRESTmoduleversions"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-MagnoliaRESTmoduleversions"></a>Magnolia REST module versions</h5>
<div class="paragraph">
<p>Make sure you use the same version for all Magnolia REST modules on
which you depend.</p>
</div>
<div class="paragraph">
<p>The version of the Magnolia REST modules depends on the version of
Magnolia you use to run your custom endpoint. We recommend you check the
.pom file (or the parent .pom file) of your Magnolia webapp. The .pom
file manages the version of the Magnolia REST modules using the property
<code>restVersion</code>. If you are unsure, use the latest released version, which
is currently: 2.2.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-recommended-dependencies"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-recommended-dependencies"></a><span id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-recommended-dependencies2 " class="confluence-anchor-link">#</span>#</h4>

</div>
</div>
<div class="sect2">
<h3 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-HowtocreateaJavaclassthatactsasaRESTresource"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-HowtocreateaJavaclassthatactsasaRESTresource"></a>How to create a Java class that acts as a REST resource</h3>
<div class="paragraph">
<p>To create a Java class that acts as a REST resource, write a Java class
— your service — and register this service in the Magnolia
<code>configuration</code> workspace. Registering the service makes sure that the
REST resource can be accessed by a default Magnolia servlet.</p>
</div>
<div class="paragraph">
<p>In this section we create a simple endpoint implementation and explain
some important details for every custom Java REST endpoint in the
context of Magnolia.</p>
</div>
<div class="sect3">
<h4 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-CreatingtheJavaclass"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-CreatingtheJavaclass"></a>Creating the Java class</h4>
<div class="paragraph">
<p>Create the class <code>com.example.rest.service.v1.DemoEndpoint</code>. This is the
code for a simple working example:</p>
</div>
<div class="paragraph">
<p><code>package`</code> com.example.rest.service.v1;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> info.magnolia.rest.AbstractEndpoint;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> info.magnolia.rest.EndpointDefinition;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> javax.ws.rs.GET;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> javax.ws.rs.Path;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> javax.ws.rs.Produces;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> javax.ws.rs.core.MediaType;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> javax.ws.rs.core.Response;`</p>
</div>
<div class="paragraph">
<p><code>@Path<code>(</code>"/demo/v1"`</code>)`</p>
</div>
<div class="paragraph">
<p><code>public<code> </code>class<code> DemoEndpoint&lt;D </code>extends<code> EndpointDefinition&gt; </code>extends`</code> AbstractEndpoint&lt;D&gt; {`</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> DemoEndpoint(D endpointDefinition) {`</p>
</div>
<div class="paragraph">
<p>`        <code>super</code>(endpointDefinition);`</p>
</div>
<div class="paragraph">
<p>`    }`</p>
</div>
<div class="paragraph">
<p>`    <code>@Path</code>(<code>"/hello"</code>)`</p>
</div>
<div class="paragraph">
<p>`    <code>`@GET</code></p>
</div>
<div class="paragraph">
<p>`    <code>@Produces</code>({MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML})`</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> Response hello() {`</p>
</div>
<div class="paragraph">
<p>`        <code>return</code> Response.ok().build();`</p>
</div>
<div class="paragraph">
<p>`    }`</p>
</div>
<div class="paragraph">
<p><code>}</code></p>
</div>
<div class="paragraph">
<p>In the example above, note that the class:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Extends AbstractEndpoint (line 13).</p>
</li>
<li>
<p>Has at least one method, which (here) has the return type
`javax.ws.rs.core.Response `.</p>
</li>
<li>
<p>Declares its path on both the class and the method level (lines 12,
19).</p>
</li>
<li>
<p>Declares its response type(s) (line 21).</p>
</li>
<li>
<p>Declares the HTTP methods through which it can be accessed (line 20).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s have a closer look at some of these details below.</p>
</div>
<div class="sect4">
<h5 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-Extendinginfo.magnolia.rest.AbstractEndpoint"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-Extendinginfo.magnolia.rest.AbstractEndpoint"></a>Extending info.magnolia.rest.AbstractEndpoint</h5>
<div class="paragraph">
<p>See line 13 in the example above. By extending AbstractEndpoint , the
endpoint can be configured. We will see later on what the configuration
and registration looks like. When a request comes to Magnolia mapped to
this endpoint, an instance is created via
<a href="https://en.wikipedia.org/wiki/Inversion_of_control">Inversion of Control
(IoC)</a>. During this process, the IoC framework also creates an instance
of EndpointDefinition , which is injected into the constructor of our
endpoint class.</p>
</div>
</div>
<div class="sect4">
<h5 id="src-196596420_safe-id-SG93dG9jcmVhdGVhY3VzdG9tSmF2YS1iYXNlZFJFU1RlbmRwb2ludC1Vc2luZ2phdmF4LndzLnJzLiphbm5vdGF0aW9ucw"><a class="anchor" href="#src-196596420_safe-id-SG93dG9jcmVhdGVhY3VzdG9tSmF2YS1iYXNlZFJFU1RlbmRwb2ludC1Vc2luZ2phdmF4LndzLnJzLiphbm5vdGF0aW9ucw"></a>Using javax.ws.rs.* annotations</h5>
<div class="paragraph">
<p>If you are not yet familiar with the `javax.ws.rs.* `package, we
recommend you take some time to learn the basics. This package contains
many annotations that can be used to declare the details of Java-based
REST resources. We will see how to use these annotations below.</p>
</div>
</div>
<div class="sect4">
<h5 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-Returningjavax.ws.rs.core.Response"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-Returningjavax.ws.rs.core.Response"></a>Returning javax.ws.rs.core.Response</h5>
<div class="paragraph">
<p><code>javax.ws.rs.core.Response</code> is the standard response type for a Java
REST endpoint.</p>
</div>
<div class="paragraph">
<p>On line 22 we declare the return type.</p>
</div>
<div class="paragraph">
<p>On line 23 we use the static method <code>#ok</code> (without an argument), which
ensures that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The HTTP response code is 200 (if everything else goes well).</p>
</li>
<li>
<p>Since we use the method <code>#ok</code> with no argument, no payload is created
and the response does not have a body, just headers.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="src-196596420_safe-id-SG93dG9jcmVhdGVhY3VzdG9tSmF2YS1iYXNlZFJFU1RlbmRwb2ludC1VbmRlcnN0YW5kaW5nQFByb2R1Y2luZw"><a class="anchor" href="#src-196596420_safe-id-SG93dG9jcmVhdGVhY3VzdG9tSmF2YS1iYXNlZFJFU1RlbmRwb2ludC1VbmRlcnN0YW5kaW5nQFByb2R1Y2luZw"></a>Understanding @Producing</h5>
<div class="paragraph">
<p>On line 21, by using the <code>@Produces</code> annotation, we can declare a list
of possible HTTP response content types.</p>
</div>
<div class="paragraph">
<p>Note that, in our example, there is no need to declare the HTTP response
content type because the method only returns response headers but no
response body. However, if the method creates a payload (for instance
JSON or XML) to be returned as an HTTP response body, then you should
declare the response content type with @Produces.</p>
</div>
</div>
<div class="sect4">
<h5 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-understanding-path"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-understanding-path"></a><span id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-understanding-path2 " class="confluence-anchor-link">#</span>#</h5>

</div>
<div class="sect4">
<h5 id="src-196596420_safe-id-SG93dG9jcmVhdGVhY3VzdG9tSmF2YS1iYXNlZFJFU1RlbmRwb2ludC1VbmRlcnN0YW5kaW5nQFBhdGg"><a class="anchor" href="#src-196596420_safe-id-SG93dG9jcmVhdGVhY3VzdG9tSmF2YS1iYXNlZFJFU1RlbmRwb2ludC1VbmRlcnN0YW5kaW5nQFBhdGg"></a>Understanding @Path</h5>
<div class="paragraph">
<p>A method on a REST endpoint has a distinct path to access it with a
RESTful URL. A path generally consists of several parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Magnolia REST base path</strong>: <code>/&lt;context&gt;/.rest</code>.<br>
If you are running a local development bundle, the base REST path is
typically <code>/magnoliaAuthor/.rest</code> or <code>/magnoliaPublic/.rest</code>.<br>
On a productive environment, where you serve the webapp from the root
context, the base REST path is <code>/.rest</code>.<br>
This path is mapped to the Magnolia REST servlet.</p>
</li>
<li>
<p><strong>REST endpoint base path</strong>. This path is declared on the class level
with the <code>@Path</code> annotation; see line 12 on the example above.<br>
This path in our example is <code>/demo/v1</code>.<br>
The value of this path can be chosen arbitrarily. Note that it typically
contains the version of the endpoint (which is <code>/v1</code> here).<br>
If your
<a href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-java-package-name">package
name</a> reflects the version, you can use the same version identifier on
both the package name and the endpoint base path.</p>
</li>
<li>
<p><strong>REST endpoint method path</strong>. This path is declared on the method level
with the <code>@Path</code> annotation; see line 19 on the example above.<br>
The example shown is static with the value <code>/hello</code>. However, the method
path can be dynamic in combination with <code>@PathParam</code>, we will see an
example later on.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To summarize, the path to a REST "resource" is a combination of:</p>
</div>
<div class="paragraph">
<p>Magnolia REST base path</p>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="paragraph">
<p>REST endpoint base path</p>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="paragraph">
<p>REST endpoint method path</p>
</div>
<div class="paragraph">
<p>/&lt;context&gt;/.rest</p>
</div>
<div class="paragraph">
<p>/demo/v1</p>
</div>
<div class="paragraph">
<p>/hello</p>
</div>
<div class="paragraph">
<p><code>/&lt;context&gt;/.rest/demo/v1/hello</code></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-declaring-http-method"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-declaring-http-method"></a><span id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-declaring-http-method2 " class="confluence-anchor-link">#</span>#</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-DeclaringtheHTTPmethod"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-DeclaringtheHTTPmethod"></a>Declaring the HTTP method</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On line 20 we use the annotation <code>@GET</code>. This declares that the REST
resource defined by this method can be accessed with the HTTP method GET
only.</p>
</div>
<div class="paragraph">
<p>If you try to access the resources using another method (for example
with POST), the resource returns an error HTTP response code. We will
test this later on with <a href="https://en.wikipedia.org/wiki/CURL">cURL</a>.</p>
</div>
<div class="paragraph">
<p>You can only declare one HTTP method per method. The Java compiler shows
an error if you try to declare two methods (by using two annotations).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-RegisteringtheRESTresourceinMagnolia"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-RegisteringtheRESTresourceinMagnolia"></a>Registering the REST resource in Magnolia</h2>
<div class="sectionbody">
<div class="paragraph">
<p>REST resources in Magnolia should be registered within your custom
module. This ensures that the REST resource and its configuration are
known in the Magnolia EndpointDefinitionRegistry .</p>
</div>
<div class="paragraph">
<p><strong>Example</strong> : Registering the endpoint: <strong>YAML file</strong></p>
</div>
<div class="paragraph">
<p>&lt;module name&gt;/rest-endpoints/demo.yaml</p>
</div>
<div class="paragraph">
<p><code>class`</code>: info.magnolia.rest.service.node.definition.ConfiguredNodeEndpointDefinition`</p>
</div>
<div class="paragraph">
<p><code>implementationClass: com.example.rest.service.v1.DemoEndpoint</code></p>
</div>
<div class="paragraph">
<p><strong>JCR node</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Node name</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">modules</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;your-module&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rest-endpoints</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">demo</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info.magnolia.rest.service.node.definition.ConfiguredNodeEndpointDefinition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">implementationClass</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.example.rest.service.v1.DemoEndpoint</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rest-endpoints</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>required</strong></p>
</div>
<div class="paragraph">
<p>The folder which contains a list of endpoint definitions. The name of
the folder must be <code>rest-endpoints</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;endpoint-name&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>required</strong></p>
</div>
<div class="paragraph">
<p>The name of the endpoint. The name is arbitrary but must be unique.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>required</strong></p>
</div>
<div class="paragraph">
<p>The fully qualified class name of the definition class. Typically
<code>info.magnolia.rest.EndpointDefinition</code> or a subclass.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>implementationClass</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>required</strong></p>
</div>
<div class="paragraph">
<p>The fully qualified class name of the REST endpoint java class.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-GrantingaccesstotheRESTresourceintheSecurityapp"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-GrantingaccesstotheRESTresourceintheSecurityapp"></a>Granting access to the REST resource in the Security app</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The last step before you can access the resource with a client is to
grant access to the REST resource in the Security app.</p>
</div>
<div class="paragraph">
<p>Permissions to issue REST requests are controlled using the standard
Magnolia
<a href="https://wiki.magnolia-cms.com/display/DOCS62/Roles+and+access+control+lists">role-based
security mechanism</a> .</p>
</div>
<div class="paragraph">
<p>The <code>magnolia-rest-integration</code> module installs a <code>rest</code> role which has
the
<a href="https://wiki.magnolia-cms.com/display/DOCS62/Default+permissions">permission
to issue requests</a> to the <code>nodes</code> and <code>properties</code> endpoints by default.</p>
</div>
<div class="paragraph">
<p>You can extend the existing <code>rest</code> role to provide web access to the
path of your custom REST resource, or you can duplicate the existing
role to create a new one just for your use case. In either case, make
sure that you assign this role to the users who need to access this
resource.</p>
</div>
<div class="paragraph">
<p>For our example we create a new role named <code>demo-rest-role</code> and assign
it to <code>superuser</code> on the magnoliaAuthor instance. You also can
<a href="https://git.magnolia-cms.com/projects/DOCUMENTATION/repos/demo-rest-services/raw/src/main/resources/mgnl-bootstrap/demo-rest-services/userroles.demo-rest-role.xml?at=refs%252Fheads%252Fmaster">download
this role</a> from the
<a href="https://git.magnolia-cms.com/projects/DOCUMENTATION/repos/demo-rest-services">GIT
repository</a>.</p>
</div>
<div class="sect2">
<h3 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-Detailsoftherole"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-Detailsoftherole"></a>Details of the role</h3>
<div class="paragraph">
<p>Role info:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/images/download/attachments/196596420/6-1-HowtocreateacustomJavabasedRESTendpoint-addRole.png" alt="images/download/attachments/196596420/6-1-HowtocreateacustomJavabasedRESTendpoint-addRole.png"></span></p>
</div>
<div class="paragraph">
<p>Access Control Lists (ACL):</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/images/download/attachments/196596420/6-1-HowtocreateacustomJavabasedRESTendpoint-ACL.png" alt="images/download/attachments/196596420/6-1-HowtocreateacustomJavabasedRESTendpoint-ACL.png"></span></p>
</div>
<div class="paragraph">
<p>Web access:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/images/download/attachments/196596420/6-1-HowtocreateacustomJavabasedRESTendpoint-webAccess.png" alt="images/download/attachments/196596420/6-1-HowtocreateacustomJavabasedRESTendpoint-webAccess.png"></span></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Access type</th>
<th class="tableblock halign-left valign-top">Path</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Deny</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/.rest*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deny all to begin.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Get&amp;Post</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/.rest/swagger*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allow access to the Swagger tools. This
is only required if you have the <code>magnolia-rest-tools</code> module installed,
which is used for testing and development purposes only.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Get&amp;Post</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/.rest/demo/v1*</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Allow access to our custom endpoint whose access path is
<code>.rest/demo/v1</code>, as explained in
<a href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-understanding-path">Understanding
@Path</a>.</p>
</div>
<div class="paragraph">
<p>Note that <code>Get</code> would be sufficient, but we use <code>Get&amp;Post</code> since we will
create more methods later on.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Access type meanings:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Access type</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Deny</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Everything is denied.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Get</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only the HTTP method <code>GET</code> is allowed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Get&amp;Post</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All HTTP methods available are allowed: <code>GET</code>, <code>POST</code>,
<code>PUT</code> and <code>DELETE</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This is the list of roles assigned to superuser:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/images/download/attachments/196596420/6-1-HowtocreateacustomJavabasedRESTendpoint-superuserRole.png" alt="images/download/attachments/196596420/6-1-HowtocreateacustomJavabasedRESTendpoint-superuserRole.png"></span></p>
</div>
<div class="paragraph">
<p>Depending on your bundle, you may have more roles assigned to
<code>superuser</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-Accessingtheresource"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-Accessingtheresource"></a>Accessing the resource</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now everything is ready to access the custom endpoint.</p>
</div>
<div class="sect2">
<h3 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-UsingcURL"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-UsingcURL"></a>Using cURL</h3>
<div class="paragraph">
<p><a href="https://curl.haxx.se/download.html">cURL</a> is a useful tool to test REST
resources. To check if you have it installed, open a command shell and
type:</p>
</div>
<div class="paragraph">
<p><code>curl</code></p>
</div>
<div class="paragraph">
<p>When it is installed, the shell displays something like this:</p>
</div>
<div class="paragraph">
<p><code>curl: try 'curl --help' or 'curl --manual' for more information</code></p>
</div>
<div class="paragraph">
<p>Once you have confirmed that cURL works, try the following request:</p>
</div>
<div class="paragraph">
<p><code>curl -i --user superuser:superuser -X GET --header 'Accept: application/json' 'http://localhost:8080/magnoliaAuthor/.rest/demo/v1/hello'</code></p>
</div>
<div class="paragraph">
<p>Since we provide the <code>-i</code> option, cURL displays the response header.
Remember that the requested resource does not produce a payload, so
there is no response body.</p>
</div>
<div class="paragraph">
<p><code>HTTP/1.1 200 OK</code></p>
</div>
<div class="paragraph">
<p><code>Server: Apache-Coyote/1.1</code></p>
</div>
<div class="paragraph">
<p><code>Set-Cookie: JSESSIONID=624D8A0283867F9FA07D02F72B9B72EA; Path=/magnoliaAuthor/; HttpOnly</code></p>
</div>
<div class="paragraph">
<p><code>Pragma: no-cache</code></p>
</div>
<div class="paragraph">
<p><code>Cache-Control: no-cache, no-store, must-revalidate, max-age=0</code></p>
</div>
<div class="paragraph">
<p><code>Expires: Thu, 01 Jan 1970 00:00:00 GMT</code></p>
</div>
<div class="paragraph">
<p><code>Content-Type: text/html;charset=UTF-8</code></p>
</div>
<div class="paragraph">
<p><code>Content-Length: 0</code></p>
</div>
<div class="paragraph">
<p><code>Date: Tue, 04 Jul 2017 14:36:35 GMT</code></p>
</div>
<div class="paragraph">
<p>Now try to access the resource via the <code>POST</code> method:</p>
</div>
<div class="paragraph">
<p><code>curl -i --user superuser:superuser -X POST --header <code>'Accept: application/json'</code> `&#8217;<a href="http://localhost:8080/magnoliaAuthor/.rest/demo/v1/hello'" class="bare">http://localhost:8080/magnoliaAuthor/.rest/demo/v1/hello'</a></code></p>
</div>
<div class="paragraph">
<p>Here are the response headers:</p>
</div>
<div class="paragraph">
<p><code>HTTP/1.1 500 Internal Server Error</code></p>
</div>
<div class="paragraph">
<p><code>Server: Apache-Coyote/1.1</code></p>
</div>
<div class="paragraph">
<p><code>Set-Cookie: JSESSIONID=C4A7CB1D1AA09967FD4E413E61D9AA4C; Path=/magnoliaAuthor/; HttpOnly</code></p>
</div>
<div class="paragraph">
<p><code>Pragma: no-cache</code></p>
</div>
<div class="paragraph">
<p><code>Cache-Control: no-cache, no-store, must-revalidate, max-age=0</code></p>
</div>
<div class="paragraph">
<p><code>Expires: Thu, 01 Jan 1970 00:00:00 GMT</code></p>
</div>
<div class="paragraph">
<p><code>Content-Type: text/plain;charset=UTF-8</code></p>
</div>
<div class="paragraph">
<p><code>Content-Length: 79</code></p>
</div>
<div class="paragraph">
<p><code>Date: Tue, 04 Jul 2017 14:40:17 GMT</code></p>
</div>
<div class="paragraph">
<p><code>Connection: close</code></p>
</div>
<div class="paragraph">
<p><code>RESTEASY003650: No resource method found for POST, return 405 with Allow header</code></p>
</div>
<div class="paragraph">
<p>This is expected. The method <code>#hello</code> is annotated with <code>@GET `declaring
it can only be accessed with the HTTP method `GET</code>. See the section
<a href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-declaring-http-method">declaring
the HTTP method</a>.</p>
</div>
<div class="paragraph">
<p>[.admonition-icon .confluence-information-macro-icon]##</p>
</div>
<div class="paragraph">
<p>Note that you pass the username and password in clear text in this cURL
call. This is acceptable when testing on a local machine, however, we
advise against doing this to access a production environment server.</p>
</div>
<div class="paragraph">
<p>In addition to cURL, there are other ways of testing your custom
endpoint, such as Swagger tools.</p>
</div>
<div class="paragraph">
<p>[<mark>src-196596420_HowtocreateacustomJava-basedRESTendpoint-using-swagger-tools]</mark>#</p>
</div>
</div>
<div class="sect2">
<h3 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-UsingSwaggertools"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-UsingSwaggertools"></a>Using Swagger tools</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The Swagger framework is supported by a set of core tools for designing,
building, and documenting RESTful APIs.</p>
</div>
<div class="paragraph">
<p>Source: <a href="https://swagger.io/tools/" class="bare">https://swagger.io/tools/</a></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Magnolia provides integration with Swagger tools directly in the Admin
UI.</p>
</div>
<div class="paragraph">
<p>[.admonition-icon .confluence-information-macro-icon]##</p>
</div>
<div class="paragraph">
<p>Swagger tools are for development and testing purposes only.</p>
</div>
<div class="paragraph">
<p>To test your endpoints with Swagger:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the <code>magnolia-rest-tools</code> module to your webapp.</p>
</li>
<li>
<p>Set the Swagger API base path.</p>
</li>
<li>
<p>Use the Swagger annotations in your endpoint class.</p>
</li>
<li>
<p>Use the app within the Magnolia Admin UI to test your endpoints.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-Installingthemodule"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-Installingthemodule"></a>Installing the module</h4>
<div class="paragraph">
<p>Make sure the <code>magnolia-rest-tools</code> module is part of your webapp. See
<a href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-Possiblerecommenddependencies">recommended
dependencies</a> above about how to manage Swagger integration with Maven.</p>
</div>
</div>
<div class="sect3">
<h4 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-SettingtheSwaggerAPIbasepath"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-SettingtheSwaggerAPIbasepath"></a>Setting the Swagger API base path</h4>
<div class="paragraph">
<p>The Swagger API explorer tool searches for the API at a path set in
<code>/modules/rest-tools/config/apiBasepath</code>. The default value is
`http://localhost:8080/.rest `. The value for this property must match
the following pattern:</p>
</div>
<div class="paragraph">
<p><code>&lt;protocol&gt;://&lt;hostname&gt;:&lt;port&gt;/&lt;context&gt;/.rest</code></p>
</div>
<div class="paragraph">
<p>When using one of <a href="Bundles-and-webapps.html">Magnolia&#8217;s preconfigured
bundles</a> running on localhost, set the property to
`http://localhost:8080/magnoliaAuthor/.rest `.</p>
</div>
<div class="paragraph">
<p>Set the path to where REST services reside on your system. If you run
the standard Magnolia bundle and work on the author instance, set the
path to `http://localhost:8080/magnoliaAuthor/.rest `.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Node name</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">modules</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rest-tools</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">config</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">apiBasepath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://localhost:8080/magnoliaAuthor/.rest" class="bare">http://localhost:8080/magnoliaAuthor/.rest</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>After setting the base path, restart Magnolia.</p>
</div>
<div class="paragraph">
<p>Swagger is in <strong>Dev &gt; REST Tools</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-UsingSwaggerannotations"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-UsingSwaggerannotations"></a>Using Swagger annotations</h4>
<div class="paragraph">
<p>To have our custom endpoint appear in the Swagger UI, we must add some
annotations to the class of our custom endpoint.</p>
</div>
<div class="paragraph">
<p>This is the modified class of the example above — now enriched with
annotations:</p>
</div>
<div class="paragraph">
<p>com.example.rest.service.v1.DemoEndpoint</p>
</div>
<div class="paragraph">
<p><code>package`</code> com.example.rest.service.v1;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> info.magnolia.rest.AbstractEndpoint;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> info.magnolia.rest.EndpointDefinition;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> io.swagger.annotations.Api;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> io.swagger.annotations.ApiOperation;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> io.swagger.annotations.ApiResponse;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> io.swagger.annotations.ApiResponses;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> javax.ws.rs.GET;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> javax.ws.rs.Path;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> javax.ws.rs.Produces;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> javax.ws.rs.core.MediaType;`</p>
</div>
<div class="paragraph">
<p><code>import`</code> javax.ws.rs.core.Response;`</p>
</div>
<div class="paragraph">
<p><code>@Api<code>(value = </code>"/demo/v1"<code>, description = </code>"The demo endpoint"`</code>)`</p>
</div>
<div class="paragraph">
<p><code>@Path<code>(</code>"/demo/v1"`</code>)`</p>
</div>
<div class="paragraph">
<p><code>public<code> </code>class<code> DemoEndpoint&lt;D </code>extends<code> EndpointDefinition&gt; </code>extends`</code> AbstractEndpoint&lt;D&gt; {`</p>
</div>
<div class="paragraph">
<p>`    <code>private</code> <code>static</code> <code>final</code> String STATUS_MESSAGE_OK = <code>"OK"</code>;`</p>
</div>
<div class="paragraph">
<p>`    <code>private</code> <code>static</code> <code>final</code> String STATUS_MESSAGE_METHOD_NOT_ALLOWED = <code>"Method Not Allowed"</code>;`</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> DemoEndpoint(D endpointDefinition) {`</p>
</div>
<div class="paragraph">
<p>`        <code>super</code>(endpointDefinition);`</p>
</div>
<div class="paragraph">
<p>`    }`</p>
</div>
<div class="paragraph">
<p>`    <code>@Path</code>(<code>"/hello"</code>)`</p>
</div>
<div class="paragraph">
<p>`    <code>`@GET</code></p>
</div>
<div class="paragraph">
<p>`    <code>@Produces</code>({MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML})`</p>
</div>
<div class="paragraph">
<p>`    <code>@ApiOperation</code>(value = <code>"Say hello to the endpoint."</code>)`</p>
</div>
<div class="paragraph">
<p>`    <code>@ApiResponses</code>(value = {`</p>
</div>
<div class="paragraph">
<p>`            <code>@ApiResponse</code>(code = <code>200</code>, message = STATUS_MESSAGE_OK),`</p>
</div>
<div class="paragraph">
<p>`            <code>@ApiResponse</code>(code = <code>405</code>, message = STATUS_MESSAGE_METHOD_NOT_ALLOWED),`</p>
</div>
<div class="paragraph">
<p>`    })`</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> Response hello() {`</p>
</div>
<div class="paragraph">
<p>`        <code>return</code> Response.ok().build();`</p>
</div>
<div class="paragraph">
<p>`    }`</p>
</div>
<div class="paragraph">
<p>`}           `</p>
</div>
<div class="paragraph">
<p>Notes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Line 16: `@Api `— Marks a class as a Swagger resource. This is
required to see your endpoint on the Swagger UI.</p>
</li>
<li>
<p>Line 31: `@ApiOperation `— A description of the endpoint.</p>
</li>
<li>
<p>Lines 32-35: `@ApiResponses `, `@ApiResponse `— Lists the possible
response (codes).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>[.admonition-icon .confluence-information-macro-icon]##</p>
</div>
<div class="paragraph">
<p>After you add the annotations, restart the server (hot deployment will
not work).</p>
</div>
<div class="paragraph">
<p>When you open the REST Tools app again, you should see your custom
endpoint in Swagger UI list:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/images/download/attachments/196596420/swager-UI-with-demov1.png" alt="images/download/attachments/196596420/swager-UI-with-demov1.png"></span></p>
</div>
<div class="paragraph">
<p>The Swagger UI:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/images/download/attachments/196596420/swagger_demo_start.png" alt="images/download/attachments/196596420/swagger_demo_start.png"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/images/download/attachments/196596420/swagger_demo_response.png" alt="images/download/attachments/196596420/swagger_demo_response.png"></span></p>
</div>
<div class="paragraph">
<p>If the REST resource can accept parameters, the UI reflects that with
distinct fields for each parameter.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-Aboutmarshallinganddataconversion"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-Aboutmarshallinganddataconversion"></a>About marshalling and data conversion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An endpoint dealing with data must manage two types of data conversion:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Transforming data into a simple Java bean or
<a href="https://en.wikipedia.org/wiki/Plain_old_Java_object">POJO</a> (Plain Old
Java Object) and vice versa.</p>
</li>
<li>
<p>Transforming the POJO into JSON or XML and vice versa.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the endpoint handles both read (GET) and write (PUT to create and
POST to update) actions, marshalling and data conversion must also work
in both directions.</p>
</div>
<div class="paragraph">
<p>In this section we focus on some aspects of this kind of data
conversion.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/images/download/attachments/196596420/data-transformation.png" alt="images/download/attachments/196596420/data-transformation.png"></span></p>
</div>
<div class="sect2">
<h3 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-ConvertingadataobjectintoaPOJOandviceversa"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-ConvertingadataobjectintoaPOJOandviceversa"></a>Converting a data object into a POJO and vice versa</h3>
<div class="paragraph">
<p>Regardless of the type of data you deal with, in the context of a REST
endpoint, at some point you typically transform "data" into a POJO (and
vice versa).</p>
</div>
<div class="paragraph">
<p>[.admonition-icon .confluence-information-macro-icon]##</p>
</div>
<div class="paragraph">
<p>There is no "one size fits all" for transforming a data object into a
POJO and vice versa. The best solution for you depends on your use case.</p>
</div>
<div class="sect3">
<h4 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-JCRtoPOJO"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-JCRtoPOJO"></a>JCR to POJO</h4>
<div class="paragraph">
<p>The <code>magnolia-rest-services</code> module provides classes to transform JCR
nodes and properties into POJOs and vice versa.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RepositoryMarshaller is the transformer.</p>
</li>
<li>
<p>RepositoryNode is the type of the POJO.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Magnolia endpoints PropertyEndpoint and NodeEndpoint use these
classes. You also can use the classes for your custom endpoints.
However, note that the structure of the POJO and of the resulting
payload after marshalling may <em>not</em> cover your requirements.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-Marshallingandunmarshalling-creatingandreceivingpayload"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-Marshallingandunmarshalling-creatingandreceivingpayload"></a>Marshalling and unmarshalling - creating and receiving payload</h3>
<div class="paragraph">
<p>Transforming a POJO into JSON or XML is known as
<a href="https://en.wikipedia.org/wiki/Marshalling_(computer_science)">marshalling</a>.
Transforming JSON or XML into a POJO is known as
<a href="https://en.wikipedia.org/wiki/Unmarshalling">unmarshalling</a>. Both
processes are sometimes referred to as marshalling.</p>
</div>
<div class="paragraph">
<p>[.admonition-icon .confluence-information-macro-icon]##</p>
</div>
<div class="paragraph">
<p>Marshalling is handled by the REST framework by the
<a href="https://en.wikipedia.org/wiki/Java_API_for_RESTful_Web_Services">JAX-RS
API</a> implementation.</p>
</div>
<div class="paragraph">
<p>However, when dealing with payload (XML or JSON) in your endpoint, note
the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To create payload, you must <code>PUT</code> a POJO into the response of the
endpoint method.</p>
</li>
<li>
<p>When receiving payload from a request, the responsible method must
have an appropriate signature in order to initiate unmarshalling.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-AddingPOJOstotheRESTresponsetodeliverpayload"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-AddingPOJOstotheRESTresponsetodeliverpayload"></a>Adding POJOs to the REST response to deliver payload</h4>
<div class="paragraph">
<p>Imagine you have a POJO with the name <code>Lunch</code> and two properties: <code>food</code>
and <code>beverage</code>.</p>
</div>
<div class="paragraph">
<p>com.example.rest.pojos.Lunch</p>
</div>
<div class="paragraph">
<p><code>public<code> </code>class<code> Lunch </code>extends`</code> BasicStorable {`</p>
</div>
<div class="paragraph">
<p>` `</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> <code>static</code> String BADFOOD = <code>"Bad food"</code>;`</p>
</div>
<div class="paragraph">
<p>` `</p>
</div>
<div class="paragraph">
<p>`    <code>private</code> String food;`</p>
</div>
<div class="paragraph">
<p>`    <code>private</code> String beverage;`</p>
</div>
<div class="paragraph">
<p>` `</p>
</div>
<div class="paragraph">
<p>`    <code>`/**</code></p>
</div>
<div class="paragraph">
<p>`     * In the context of REST it is necessary to have a default constructor written in the class.`</p>
</div>
<div class="paragraph">
<p>`     * (Otherwise object mappers may fail when trying to create an object from a giving payload.)`</p>
</div>
<div class="paragraph">
<p>`     */`</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> Lunch() {`</p>
</div>
<div class="paragraph">
<p>` `</p>
</div>
<div class="paragraph">
<p>`    }`</p>
</div>
<div class="paragraph">
<p>` `</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> Lunch(String food, String beverage) {`</p>
</div>
<div class="paragraph">
<p>`        <code>this</code>.food = food;`</p>
</div>
<div class="paragraph">
<p>`        <code>this</code>.beverage = beverage;`</p>
</div>
<div class="paragraph">
<p>`    }`</p>
</div>
<div class="paragraph">
<p>` `</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> String getFood() {`</p>
</div>
<div class="paragraph">
<p>`        <code>return</code> food;`</p>
</div>
<div class="paragraph">
<p>`    }`</p>
</div>
<div class="paragraph">
<p>` `</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> <code>void</code> setFood(String food) {`</p>
</div>
<div class="paragraph">
<p>`        <code>this</code>.food = food;`</p>
</div>
<div class="paragraph">
<p>`    }`</p>
</div>
<div class="paragraph">
<p>` `</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> String getBeverage() {`</p>
</div>
<div class="paragraph">
<p>`        <code>return</code> beverage;`</p>
</div>
<div class="paragraph">
<p>`    }`</p>
</div>
<div class="paragraph">
<p>` `</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> <code>void</code> setBeverage(String beverage) {`</p>
</div>
<div class="paragraph">
<p>`        <code>this</code>.beverage = beverage;`</p>
</div>
<div class="paragraph">
<p>`    }`</p>
</div>
<div class="paragraph">
<p><code>}</code></p>
</div>
<div class="paragraph">
<p>Now you require a method which can deliver a <code>lunch</code> payload. Endpoint
method(s) providing a <code>Lunch</code> object would look like this:</p>
</div>
<div class="paragraph">
<p>`    <code>@Path</code>(<code>"/lunch2"</code>)`</p>
</div>
<div class="paragraph">
<p>`    <code>`@GET</code></p>
</div>
<div class="paragraph">
<p>`    <code>@Produces</code>({MediaType.APPLICATION_JSON})`</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> Response lunch2() {`</p>
</div>
<div class="paragraph">
<p>`        Lunch pojo = <code>new</code> Lunch(<code>"Rösti mit Geschnetzeltem"</code>, <code>"Ueli Weizen"</code>);`</p>
</div>
<div class="paragraph">
<p>`        <code>return</code> Response.ok(pojo).build();`</p>
</div>
<div class="paragraph">
<p>`    }`</p>
</div>
<div class="paragraph">
<p>`    <code>@Path</code>(<code>"/lunch"</code>)`</p>
</div>
<div class="paragraph">
<p>`    <code>`@GET</code></p>
</div>
<div class="paragraph">
<p>`    <code>@Produces</code>({MediaType.APPLICATION_JSON})`</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> Lunch lunch() {`</p>
</div>
<div class="paragraph">
<p>`        Lunch pojo = <code>new</code> Lunch(<code>"Svíčková na smetaně "</code>, <code>"Gambrinus Plzen"</code>);`</p>
</div>
<div class="paragraph">
<p>`        <code>return</code> pojo;`</p>
</div>
<div class="paragraph">
<p>`    }     `</p>
</div>
<div class="paragraph">
<p>Note: The seeming parallelism between
<code>new Lunch("Rösti mit Geschnetzeltem", "Ueli Weizen");</code> and
<code>new Lunch("Svíčková na smetaně ", "Gambrinus Plzen");</code> is no way
intended to present how to handle
<a href="https://wiki.magnolia-cms.com/display/DOCS62/Internationalization">internationalization</a>.</p>
</div>
<div class="paragraph">
<p>The snippet shows two methods: <code>#lunch</code> and <code>#lunch2</code>. Both produce the
same payload when called from outside, however, their implementation is
slightly different.</p>
</div>
<div class="paragraph">
<p><code>#lunch2</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Uses the generic return type <code>javax.ws.rs.core.Response</code>.</p>
</li>
<li>
<p>Puts the POJO (of the type <code>Lunch</code>) into this response; see line 6.</p>
</li>
<li>
<p>This approach provides high flexibility concerning the response code,
for instance you can do things like this:</p>
<div class="paragraph">
<p><code>return`</code> Response.status(Response.Status.NOT_ACCEPTABLE).build();`</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>//&#8230;&#8203;</code></p>
</div>
<div class="paragraph">
<p><code>return`</code> Response.status(Response.Status.BAD_REQUEST).build();`</p>
</div>
<div class="paragraph">
<p><code>#lunch</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Uses the specific POJO as return type. Here it is
<code>com.example.rest.pojos.Lunch</code>.</p>
</li>
<li>
<p>Returns the POJO directly on the method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that both method produce the same response headers and identical
payload (structure, in this example only the values of the food and
beverage properties differ).</p>
</div>
<div class="paragraph">
<p>Click to see the result of calling the above examples with cURL</p>
</div>
<div class="paragraph">
<p><code>#lunch2</code></p>
</div>
<div class="paragraph">
<p><code>curl -i --user superuser:superuser -X GET --header 'Accept: application/json' 'http://localhost:8080/magnoliaAuthor/.rest/demo/v1/lunch2'</code></p>
</div>
<div class="paragraph">
<p><code>HTTP/1.1 200 OK</code></p>
</div>
<div class="paragraph">
<p><code>Server: Apache-Coyote/1.1</code></p>
</div>
<div class="paragraph">
<p><code>Set-Cookie: JSESSIONID=427FFB4FD60492BDD7D8C76E28F91222; Path=/magnoliaAuthor/; HttpOnly</code></p>
</div>
<div class="paragraph">
<p><code>Pragma: no-cache</code></p>
</div>
<div class="paragraph">
<p><code>Cache-Control: no-cache, no-store, must-revalidate, max-age=0</code></p>
</div>
<div class="paragraph">
<p><code>Expires: Thu, 01 Jan 1970 00:00:00 GMT</code></p>
</div>
<div class="paragraph">
<p><code>Content-Type: application/json;charset=UTF-8</code></p>
</div>
<div class="paragraph">
<p><code>Content-Length: 61</code></p>
</div>
<div class="paragraph">
<p><code>Date: Wed, 05 Jul 2017 16:48:53 GMT</code></p>
</div>
<div class="paragraph">
<p><code>{"id":"b8a3da44-35cf-48a5-9f69-dc38bff881da","food":"Rösti mit Geschnetzeltem","beverage":"Ueli Weizen"}</code></p>
</div>
<div class="paragraph">
<p><code>#lunch</code></p>
</div>
<div class="paragraph">
<p><code>curl -i --user superuser:superuser -X GET --header 'Accept: application/json' 'http://localhost:8080/magnoliaAuthor/.rest/demo/v1/lunch'</code></p>
</div>
<div class="paragraph">
<p><code>HTTP/1.1 200 OK</code></p>
</div>
<div class="paragraph">
<p><code>Server: Apache-Coyote/1.1</code></p>
</div>
<div class="paragraph">
<p><code>Set-Cookie: JSESSIONID=8842AE5F355D4E4E188587483B6B0B52; Path=/magnoliaAuthor/; HttpOnly</code></p>
</div>
<div class="paragraph">
<p><code>Pragma: no-cache</code></p>
</div>
<div class="paragraph">
<p><code>Cache-Control: no-cache, no-store, must-revalidate, max-age=0</code></p>
</div>
<div class="paragraph">
<p><code>Expires: Thu, 01 Jan 1970 00:00:00 GMT</code></p>
</div>
<div class="paragraph">
<p><code>Content-Type: application/json;charset=UTF-8</code></p>
</div>
<div class="paragraph">
<p><code>Content-Length: 64</code></p>
</div>
<div class="paragraph">
<p><code>Date: Wed, 05 Jul 2017 16:51:29 GMT</code></p>
</div>
<div class="paragraph">
<p><code>{"id":"17f552a0-11e8-4d5d-898b-ecf17f05b1ba","food":"Svíčková na smetaně ","beverage":"Gambrinus Plzen"}</code></p>
</div>
<div class="paragraph">
<p>Note that the payload also contains the property <code>id</code>. This property
comes from the super class <code>com.example.rest.pojos.BasicStorable</code> of
<code>Lunch</code>; we will need this id later on.</p>
</div>
<div class="paragraph">
<p>Both approaches to produce payload with POJOs shown here work in more
complex scenarios. For example: you could return a list of POJOs; the
properties of the POJO could also be POJOs; and so on.</p>
</div>
</div>
<div class="sect3">
<h4 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-ReceivingpayloadandgettingthePOJO"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-ReceivingpayloadandgettingthePOJO"></a>Receiving payload and getting the POJO</h4>
<div class="paragraph">
<p>Endpoint methods that receive a payload (JSON or XML) are typically used
to create or update an object.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s imagine an example where the endpoint allows you add a lunch
object to a store. In the context of a data store, adding is like
creating. To create an object, a REST service is called with the the
HTTP method <code>PUT</code>.</p>
</div>
<div class="paragraph">
<p>This code snippet shows the method to add a lunch:</p>
</div>
<div class="paragraph">
<p>com.example.rest.service.v1.DemoEndpoint#storeLunch</p>
</div>
<div class="paragraph">
<p>`    <code>@Path</code>(<code>"/store-lunch"</code>)`</p>
</div>
<div class="paragraph">
<p>`    <code>@Consumes</code>({MediaType.APPLICATION_JSON})`</p>
</div>
<div class="paragraph">
<p>`    <code>`@PUT</code></p>
</div>
<div class="paragraph">
<p>`    <code>@Produces</code>({MediaType.APPLICATION_JSON})`</p>
</div>
<div class="paragraph">
<p>`    <code>public</code> Response storeLunch(Lunch lunch){`</p>
</div>
<div class="paragraph">
<p>`        <code>if</code>(lunch != <code>null</code>){`</p>
</div>
<div class="paragraph">
<p>`            <code>try</code> {`</p>
</div>
<div class="paragraph">
<p>`                store.add(lunch);`</p>
</div>
<div class="paragraph">
<p>`                <code>return</code> Response.ok(lunch).build();`</p>
</div>
<div class="paragraph">
<p>`            } <code>catch</code> (Exception e) {`</p>
</div>
<div class="paragraph">
<p>`                log.error(<code>"Failed to store the lunch"</code>);`</p>
</div>
<div class="paragraph">
<p>`                    <code>return</code> Response.status(Response.Status.NOT_ACCEPTABLE).build();`</p>
</div>
<div class="paragraph">
<p>`            }`</p>
</div>
<div class="paragraph">
<p>`        }<code>else</code>{`</p>
</div>
<div class="paragraph">
<p>`            <code>return</code> Response.status(Response.Status.BAD_REQUEST).build();`</p>
</div>
<div class="paragraph">
<p>`        }`</p>
</div>
<div class="paragraph">
<p>`    }``// eof: storeLunch`</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Line 140: It is generally considered good practice to tell the service
what type of data it consumes. However, it is not required.</p>
</li>
<li>
<p>Line 143: The most important point in the current context is the
method signature.<br>
<strong>The method must contain a parameter of the type to which the payload
should be mapped to.</strong></p>
</li>
<li>
<p>Line 146: If the mapping was successful, we add the lunch POJO to the
store. The <code>store</code> actually is a mock store, it does not really store
data in the example. (See <code>BlackboxDatastore `on Git.). However,
`store#add</code> may throw an exception if it fails.</p>
</li>
<li>
<p>Line 147: Build the response with the response code 200 (ok), and also
put the lunch object into the payload, it now carries the object id too.
Giving back the just created object could be used on a client to render
an update UI or to summarize the successful add action.</p>
</li>
<li>
<p>Line 148-150: These lines handle the exception thrown by the store.
You can provoke this by sending a payload to the method where the
property <code>food</code> has the value <code>Bad food</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can test the new method using cURL.</p>
</div>
<div class="paragraph">
<p>Click to see the result of calling the storeLunch method with cURL</p>
</div>
<div class="paragraph">
<p><code>curl -i <a href="http://localhost:8080/magnoliaAuthor/.rest/demo/v1/store-lunch" class="bare">http://localhost:8080/magnoliaAuthor/.rest/demo/v1/store-lunch</a> \</code></p>
</div>
<div class="paragraph">
<p><code>-H "Accept: application/json" \</code></p>
</div>
<div class="paragraph">
<p><code>-H "Content-Type: application/json" \</code></p>
</div>
<div class="paragraph">
<p><code>-X PUT \</code></p>
</div>
<div class="paragraph">
<p><code>--user superuser:superuser \</code></p>
</div>
<div class="paragraph">
<p><code>--data \</code></p>
</div>
<div class="paragraph">
<p><code>'{"food": "Pizza Napoli", "beverage": "Birra Moretti"}'</code></p>
</div>
<div class="paragraph">
<p><code>HTTP/1.1 200 OK</code></p>
</div>
<div class="paragraph">
<p><code>^Server: Apache-Coyote/1.1</code></p>
</div>
<div class="paragraph">
<p><code>Set-Cookie: JSESSIONID=7E99151D9036CDA5DC200BA8FE70EACB; Path=/magnoliaAuthor/; HttpOnly</code></p>
</div>
<div class="paragraph">
<p><code>Pragma: no-cache</code></p>
</div>
<div class="paragraph">
<p><code>Cache-Control: no-cache, no-store, must-revalidate, max-age=0</code></p>
</div>
<div class="paragraph">
<p><code>Expires: Thu, 01 Jan 1970 00:00:00 GMT</code></p>
</div>
<div class="paragraph">
<p><code>Content-Type: application/json;charset=UTF-8</code></p>
</div>
<div class="paragraph">
<p><code>Content-Length: 94</code></p>
</div>
<div class="paragraph">
<p><code>Date: Thu, 06 Jul 2017 16:33:04 GMT</code></p>
</div>
<div class="paragraph">
<p><code>{"id":"b64633b7-4555-4571-86b6-8e45bdab61b3","food":"Pizza Napoli","beverage":"Birra Moretti"}</code></p>
</div>
<div class="paragraph">
<p>The first attempt was successful!
<span class="image"><img src="../../_images/images/s/en_GB/8100/5084f018d64a97dc638ca9a178856f851ea353ff/<em>/images/icons/emoticons/smile.svg" alt="images/s/en_GB/8100/5084f018d64a97dc638ca9a178856f851ea353ff/</em>/images/icons/emoticons/smile.svg"></span></p>
</div>
<div class="paragraph">
<p>Now provoke an error with "Bad food":</p>
</div>
<div class="paragraph">
<p><code>curl -i <a href="http://localhost:8080/magnoliaAuthor/.rest/demo/v1/store-lunch" class="bare">http://localhost:8080/magnoliaAuthor/.rest/demo/v1/store-lunch</a> \</code></p>
</div>
<div class="paragraph">
<p><code>-H "Accept: application/json" \</code></p>
</div>
<div class="paragraph">
<p><code>-H "Content-Type: application/json" \</code></p>
</div>
<div class="paragraph">
<p><code>-X PUT \</code></p>
</div>
<div class="paragraph">
<p><code>--user superuser:superuser \</code></p>
</div>
<div class="paragraph">
<p><code>--data \</code></p>
</div>
<div class="paragraph">
<p><code>'{ "food": "Bad food", "beverage": "Bud Light"}'</code></p>
</div>
<div class="paragraph">
<p><code>HTTP/1.1 406 Not Acceptable</code></p>
</div>
<div class="paragraph">
<p><code>Server: Apache-Coyote/1.1</code></p>
</div>
<div class="paragraph">
<p><code>Set-Cookie: JSESSIONID=FEA3475D150D8106F8A265E97060BC2F; Path=/magnoliaAuthor/; HttpOnly</code></p>
</div>
<div class="paragraph">
<p><code>Pragma: no-cache</code></p>
</div>
<div class="paragraph">
<p><code>Cache-Control: no-cache, no-store, must-revalidate, max-age=0</code></p>
</div>
<div class="paragraph">
<p><code>Expires: Thu, 01 Jan 1970 00:00:00 GMT</code></p>
</div>
<div class="paragraph">
<p><code>Content-Length: 0</code></p>
</div>
<div class="paragraph">
<p><code>Date: Thu, 06 Jul 2017 16:36:15 GMT</code></p>
</div>
<div class="paragraph">
<p>The "Bad food" was rejected. No payload was returned and the HTTP
response code is 406 (Not Acceptable).</p>
</div>
<div class="paragraph">
<p>Implementing a method to update an object (and using the HTTP method
<code>POST</code>) works in a similar way. In such a case, the payload sent to the
REST endpoint must contain the object id in order to update the correct
item on the data store.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-Thesame-originpolicyproblem"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-Thesame-originpolicyproblem"></a>The same-origin policy problem</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s assume you want to use a data API endpoint to serve content
managed with Magnolia apps to independent applications located "outside"
of Magnolia. For example, you want to use an AngularJS application to
display your content.<br>
We also assume Magnolia and the Angular application are hosted on
completely different systems.</p>
</div>
<div class="paragraph">
<p>According to the same-origin policy:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>(&#8230;&#8203;) a web browser permits scripts contained in a first web page to
access data in a second web page, but only if both web pages have the
same <em>origin</em>.</p>
</div>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/Same-origin_policy">Wikipedia</a></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Therefore, if your application resides within a domain that is different
from the domain that hosts your data, the web browser will actively
prevent accessing content stored under the host domain.</p>
</div>
<div class="paragraph">
<p>An elegant solution to solve the same-origin policy without changing
Apache configuration is the Magnolia
<a href="https://wiki.magnolia-cms.com/display/DOCS62/Filters">Add HTTP Headers</a>
filter. This filter is available out-of-the-box; you only need to
configure it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="src-196596420_HowtocreateacustomJava-basedRESTendpoint-SamplecodeonGIT"><a class="anchor" href="#src-196596420_HowtocreateacustomJava-basedRESTendpoint-SamplecodeonGIT"></a>Sample code on GIT</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The sample code for the examples on this page is available on the
<a href="https://git.magnolia-cms.com/projects/DOCUMENTATION/repos/demo-rest-services">Magnolia
GIT repository</a>.</p>
</div>
<div class="paragraph">
<p>How to get content as JSON - an overview</p>
</div>
<div class="paragraph">
<p>How to create and use a custom Magnolia Maven module for custom Java
components</p>
</div>
<div class="paragraph">
<p><a href="#" class="bare">#</a></p>
</div>
</div>
</div>
</article>
<aside class="article-aside hidden" role="navigation">
    <h3 class="toc-title">PAGE CONTENTS</h3>
    <div id="article-toc"></div>
</aside>
<script>
    var clipboard = new ClipboardJS('.btn');

    clipboard.on('success', function (e) {
        console.log(e);
    });

    clipboard.on('error', function (e) {
        console.log(e);
    });
</script>
</main>
</div>
<footer class="footer">
    <p> &copy; <span id="year"></span> <a href="http://www.magnolia-cms.com" target="_blank"
        title="Link to Magnolia's official website" class="footer-link">Magnolia CMS</a></p>
    
    <div class="footer-bottom">
      <hr class="footer-hr">
    </div>

    <div class="bottom-icons">
      <a href="https://www.facebook.com/Magnolia" target="_blank" title="Magnolia's Facebook Page"><i class="fa fa-facebook fa-2x" aria-hidden="true"></i></a> <a href="https://twitter.com/magnolia_cms" target="_blank" title="Magnolia's Twitter Page"><i class="fa fa-twitter fa-2x" aria-hidden="true"></i></a> <a href="https://www.linkedin.com/company/magnolia-cms/" target="_blank" title="Magnolia's LinkedIn Page"><i
        class="fa fa-linkedin fa-2x" aria-hidden="true"></i></a>
    </div>

    <div class="bottom-logo">

    </div>

</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.10.0/tocbot.min.js"></script>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script>
    document.getElementById("year").innerHTML = new Date().getFullYear();
</script>

<script>
    tocbot.init( {
        tocSelector: '#article-toc',
        contentSelector: 'article',
        headingSelector: 'h1, h2, h3, h4, h5',
        collapseDepth: 3,
        positionFixedSelector: null,
        scrollSmooth: true,
        scrollSmoothDuration: 420
    } );
    var tocList = document.getElementById( 'article-toc' ).getElementsByClassName( 'toc-list' );
    if ( tocList && tocList.length > 0 && tocList[0].childNodes.length > 0 ) {
        document.getElementById( 'article-toc' ).parentNode.classList.remove( 'hidden' );
    }
</script>

 <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
  <script type="text/javascript"> docsearch({
      appId: '89ZVZ4S26W',
      apiKey: 'a797119372b8a613eb38a9564867085c',
      indexName: 'dev_DOCS',
      inputSelector: '#searchBar',
      algoliaOptions: { hitsPerPage: 10 },
    });
  </script>
  </body>
</html>
