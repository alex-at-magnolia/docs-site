<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Performance issues - Magnolia 6.2 documentation :: Magnolia CMS Docs</title>
    <link rel="canonical" href="http://localhost:9096/magnolia-docs/core/administration/Performance-issues.html">
    <meta name="generator" content="Antora 2.3.3">
<link rel="stylesheet" href="../../../_/css/site.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
    integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
        <script src="https://use.fontawesome.com/ecc89e1666.js"></script>
    <script
        src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
        crossorigin="anonymous">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item magnolia-logo" href="../../../index.html">
      </a>
      <input type="search" placeholder="Search the docs" name="search" id="searchBar">


      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
      
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item disabled" href="../../../magnolia-docs/core/index.html">Core</a>
        <a class="navbar-item disabled" href="../../../magnolia-docs/cloud/index.html">Cloud</a>
        <a class="navbar-item disabled" href="../../../magnolia-docs/faqs.html">FAQs</a>
        <a href="https://www.magnolia-cms.com/get-started.html" class="navbar-item" target="_blank"><button class="magnolia-btn">Try Magnolia</button></a>
      </div>
    </div>
  </nav>
</header>
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">master</button>
  <div class="version-menu">
    <a class="version is-current" href="Performance-issues.html">master</a>
    <a class="version" href="../../6.2.1/core/administration/Performance-issues.html">6.2.1</a>
    <a class="version is-missing" href="../../6.2/index.html">6.2</a>
  </div>
</div>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Magnolia Documentation</a></li>
    <li><a href="Performance-issues.html">Performance issues - Magnolia 6.2 documentation</a></li>
  </ul>
</nav>
</div>
<div class="body">
<div class="nav-container" data-component="magnolia-docs" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Get Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/hello-magnolia.html">Hello Magnolia</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cloud/getting-started/hello-cloud.html">Hello Magnolia Cloud</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Dump</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../releases/Releases.html">Releases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrade/Upgrading-to-Magnolia-6.2.x.html">Upgrading-to-Magnolia-6.2.x</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../features/Features.html">Features</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cloud/Magnolia-Cloud.html">Cloud</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="Administration.html">Administration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../developing/Developing.html">Developing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../templating/Templating.html">Templating</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../modules/Modules.html">Modules</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../authoring/Authoring.html">Authoring</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../authoring/Logging_in.html">Logging in</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../authoring/Editing_pages.html">Editing pages</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../authoring/Managing_pages.html">Managing pages</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../authoring/Editing_images.html">Editing images</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../authoring/Managing_assets.html">Managing assets</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../authoring/Publishing.html">Publishing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../authoring/Deleting_and_restoring.html">Deleting and restoring</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../authoring/Versioning.html">Versioning</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../authoring/Keyboard_shortcuts.html">Keyboard shortcuts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../authoring/Feeds.html">Feeds</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connector-packs/Connector_Packs.html">Connector Packs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../apps/Apps.html">Apps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../cli/Magnolia-CLI.html">Command Line Interface</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#core/cli/Magnolia-CLI-v3.html">Magnolia CLI v3</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#core/cli/Updating-CLI-to-v3.html">Updating CLI to v3</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#core/cli/Magnolia-CLI-v2.html">Magnolia CLI v2</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#core/cli/Magnolia-CLI-walkthrough.html">Magnolia CLI walkthrough</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../special-features/Special-Features.html">Special Features</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../support/Support.html">Need Support?</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
  </div>
</div>
    </div>
  </aside>
</div>
<main>
<article class="doc">
    <h1 class="page">Performance issues - Magnolia 6.2 documentation</h1>
    <div id="preamble">
<div class="sectionbody">
<div id="ht-loader" class="paragraph">
<p>This content cannot be displayed without JavaScript.<br>
Please enable JavaScript and reload the page.</p>
</div>
<div class="paragraph">
<p><a href="" class="bare"></a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_docs62"><a class="anchor" href="#_docs62"></a><span class="ht-logo-label">DOCS62</span> <span class="image"><img src="../../_images/DOCS62.png" alt="image"></span></h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="Administration.html" class="bare">Administration.html</a></p>
</div>
<div class="sect2">
<h3 id="_magnolia_6_2_documentation"><a class="anchor" href="#_magnolia_6_2_documentation"></a>Magnolia 6.2 documentation</h3>
<div id="ht-sidebar-dragbar" class="paragraph">
<p><span class="drag-handle-1"> [.drag-handle-2]</span> [.drag-handle-3]##</p>
</div>
<div id="ht-breadcrumb" class="ulist">
<ul>
<li>
<p><a href="Administration.html">Magnolia 6.2 documentation</a></p>
</li>
<li>
<p><a href="">&#8230;&#8203;</a></p>
</li>
<li>
<p><a href="Troubleshooting.html">Troubleshooting</a></p>
</li>
<li>
<p><a href="Known-issues.html">Known issues</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="src-196595965"><a class="anchor" href="#src-196595965"></a>Performance issues</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="src-196595965_Performanceissues-InsufficientsystemresourcesforDeeplearning4joperations"><a class="anchor" href="#src-196595965_Performanceissues-InsufficientsystemresourcesforDeeplearning4joperations"></a>Insufficient system resources for Deeplearning4j operations</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you experience memory or performance issues when using the
Deeplearning4j library, please consult first the recommendations given
on <a href="https://deeplearning4j.org/docs/latest/deeplearning4j-config-memory" class="bare">https://deeplearning4j.org/docs/latest/deeplearning4j-config-memory</a>
and check them against the configuration of your system. Pay a special
attention to the advice mentioned in the following two sections on the
page:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><em>Configuring Memory Limits</em></p>
</li>
<li>
<p><em>Gotchas: A few things to watch out for</em></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="src-196595965_Performanceissues-AdminCentralUIisslow"><a class="anchor" href="#src-196595965_Performanceissues-AdminCentralUIisslow"></a>AdminCentral UI is slow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The UI might get slower over time. One of the possible causes –
especially when there&#8217;s no log indication of any specific issue – is a
high number <a href="https://wiki.magnolia-cms.com/display/DOCS62/Tasks">tasks</a>
and/or
<a href="https://wiki.magnolia-cms.com/display/DOCS62/Message+types#Messagetypes-Notifications">notifications</a>
stored in the user&#8217;s profile. You can check the total number of tasks
and notifications stored in your profile using the the
<a href="https://wiki.magnolia-cms.com/display/DOCS62/Tasks+app">Tasks</a> and
<a href="https://wiki.magnolia-cms.com/display/DOCS62/Notifications+app">Notifications</a>
apps, respectively.</p>
</div>
<div class="paragraph">
<p>If the number exceeds several hundreds, try resolving or removing all
the non-essential items.
<span class="image"><img src="../../_images/images/s/en_GB/8100/5084f018d64a97dc638ca9a178856f851ea353ff/<em>/images/icons/emoticons/warning.svg" alt="images/s/en_GB/8100/5084f018d64a97dc638ca9a178856f851ea353ff/</em>/images/icons/emoticons/warning.svg"></span>
You should <em>not</em> experience a UI performance degradation unless more
than several thousands of items are stored in your profile.</p>
</div>
<div class="paragraph">
<p>Tasks and notifications are aggregated by
<a href="Default-roles%2C-groups-and-users.html#src-196595930_safe-id-RGVmYXVsdHJvbGVzLGdyb3Vwc2FuZHVzZXJzLURlZmF1bHRncm91cHM">Group</a>.
If a person belonging to the Editors group deletes all notifications,
this action will impact all others in that Group.</p>
</div>
<div class="paragraph">
<p>Finally, remember to check all Author instances for a high tasks and
notifications count - Production, UAT/QA, Dev and others.</p>
</div>
<div class="paragraph">
<p>[.admonition-icon .confluence-information-macro-icon]##</p>
</div>
<div class="paragraph">
<p>Following this procedure will fix the UI performance only for your
account. If multiple users are experiencing slower UI, each should check
the number of notifications and reduce it if needed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="src-196595965_Performanceissues-URLtooklongerthannsecondstorender"><a class="anchor" href="#src-196595965_Performanceissues-URLtooklongerthannsecondstorender"></a>URL took longer than n seconds to render</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Magnolia logs warning messages when URLs load slowly:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WARN info.magnolia.module.cache.filter.CacheFilter : The following URL took longer than 10 seconds (57369 ms) to render &#8230;&#8203;</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This message is produced by Magnolia&#8217;s CacheFilter. It&#8217;s purpose is to
let you know that your installation is not behaving optimally.
<a href="Monitoring.html">Enable debugging</a> on cache related classes to find
out whether resources are served slowly from the cache or the
repository. You can also use Firebug or Chrome&#8217;s developer tools to see
how long it takes for a resource to be received by the server. This may
provide hints to narrow down the issue. For example, images stored at a
CDN may be served slowly.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../../_images/images/s/en_GB/8100/5084f018d64a97dc638ca9a178856f851ea353ff/<em>/images/icons/emoticons/warning.svg" alt="images/s/en_GB/8100/5084f018d64a97dc638ca9a178856f851ea353ff/</em>/images/icons/emoticons/warning.svg"></span>
This type of issue arises mostly due to environmental issues, rather
than Magnolia directly.</p>
</div>
<div class="paragraph">
<p>To improve performance, try these suggestions in the following order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Check the memory and CPU usage. If the capacity assigned to server is
used up, assign more resources.</p>
</li>
<li>
<p>Establish when the issue occurs. All the time? At certain hours? Can
you match it to publishing or running bulk load operations like huge
import handler jobs? Does it coincide with a spike in visitors? Are both
instances affected?</p>
</li>
<li>
<p>Identify the filters that cause the issue. You can use
PerformanceTestFilter to find out how long a subchain of filters takes
to execute. Add the <code>PerformanceTestFilter</code> in different positions in
the <a href="Filters.html">filter chain</a> in <code>/server/filters</code>. Identify which
filters take a long time to run.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="src-196595965_Performanceissues-FindBarqueryingslowsdowntheinstance"><a class="anchor" href="#src-196595965_Performanceissues-FindBarqueryingslowsdowntheinstance"></a>Find Bar querying slows down the instance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When Admincentral initializes, the Find Bar is querying the full user
repository including the public users. This may lead to a massive
performance degradation for clients with a huge number of public users.</p>
</div>
<div class="paragraph">
<p>You can configure the <code>editorRoles</code> property to limit the range of user
roles allowed in the <em>Last editor</em> Find Bar search filter. For more
details see, the
<a href="https://wiki.magnolia-cms.com/display/DOCS62/Admincentral+module">Administration
module</a> page.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="src-196595965_Performanceissues-Deeplearning4j"><a class="anchor" href="#src-196595965_Performanceissues-Deeplearning4j"></a>Deeplearning4j</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="src-196595965_Performanceissues-Memorysizingissues"><a class="anchor" href="#src-196595965_Performanceissues-Memorysizingissues"></a>Memory sizing issues</h3>
<div class="paragraph">
<p>Magnolia&#8217;s <a href="https://wiki.magnolia-cms.com/display/DOCS62/Find+Bar">Find
Bar</a> uses AI that is based on <a href="https://deeplearning4j.org">Deep Learning
for Java</a> (Deeplearning4j) to present the user with the most relevant
results. Magnolia creates one neural network per Magnolia user. Behind
the scenes, that library maps each user to a chunk of off-heap memory.</p>
</div>
<div class="paragraph">
<p>The problem that some instances run into is that DL4J&#8217;s default behavior
is to allow as much off-heap memory available as <code>Xmx</code>. Meaning that on
a server where 4G of RAM are reserved for Magnolia, the whole process
might consume up to 8G RAM, which will lead to memory starvation on a
8GB or less system, for instance.</p>
</div>
<div class="paragraph">
<p>While that default makes sense for AI projects, AI in Magnolia is a
small fraction of what the Java process does. This default should
therefore be overriden. To achieve this, the following flag can be used:
<code>-Dorg.bytedeco.javacpp.maxbytes</code></p>
</div>
<div class="paragraph">
<p>For instance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Xmx</code> is 4G</p>
</li>
<li>
<p><code>-Dorg.bytedeco.javacpp.maxbytes=400M</code></p>
</li>
<li>
<p>Magnolia will require 4.4G of physical RAM in total</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Since the 6.2.2 release, which bundles DL4J 1.0.0-beta7, and its
dependency javacpp at version 1.5.3, we recommend to use relative units
instead:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Xmx</code> is 4G</p>
</li>
<li>
<p><code>-Dorg.bytedeco.javacpp.maxbytes=10%</code></p>
</li>
<li>
<p>Magnolia will require 4.4G of physical RAM in total, and will adapt
regardless of the environment it is run on</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="src-196595965_Performanceissues-InsufficientsystemresourcesforDeeplearning4joperations.1"><a class="anchor" href="#src-196595965_Performanceissues-InsufficientsystemresourcesforDeeplearning4joperations.1"></a>Insufficient system resources for Deeplearning4j operations</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you experience memory or performance issues when using the
Deeplearning4j library, please consult first the recommendations given
on <a href="https://deeplearning4j.org/docs/latest/deeplearning4j-config-memory" class="bare">https://deeplearning4j.org/docs/latest/deeplearning4j-config-memory</a>
and check them against the configuration of your system. Pay a special
attention to the advice mentioned in the following two sections on the
page:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><em>Configuring Memory Limits</em></p>
</li>
<li>
<p><em>Gotchas: A few things to watch out for</em></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Known issues</p>
</div>
<div class="paragraph">
<p>Non EE receiver or subscriber</p>
</div>
<div class="paragraph">
<p><a href="#" class="bare">#</a></p>
</div>
</div>
</div>
</div>
</article>
<aside class="article-aside hidden" role="navigation">
    <h3 class="toc-title">PAGE CONTENTS</h3>
    <div id="article-toc"></div>
</aside>
<script>
    var clipboard = new ClipboardJS('.btn');

    clipboard.on('success', function (e) {
        console.log(e);
    });

    clipboard.on('error', function (e) {
        console.log(e);
    });
</script>
</main>
</div>
<footer class="footer">
    <p> &copy; <span id="year"></span> <a href="http://www.magnolia-cms.com" target="_blank"
        title="Link to Magnolia's official website" class="footer-link">Magnolia CMS</a></p>
    
    <div class="footer-bottom">
      <hr class="footer-hr">
    </div>

    <div class="bottom-icons">
      <a href="https://www.facebook.com/Magnolia" target="_blank" title="Magnolia's Facebook Page"><i class="fa fa-facebook fa-2x" aria-hidden="true"></i></a> <a href="https://twitter.com/magnolia_cms" target="_blank" title="Magnolia's Twitter Page"><i class="fa fa-twitter fa-2x" aria-hidden="true"></i></a> <a href="https://www.linkedin.com/company/magnolia-cms/" target="_blank" title="Magnolia's LinkedIn Page"><i
        class="fa fa-linkedin fa-2x" aria-hidden="true"></i></a>
    </div>

    <div class="bottom-logo">

    </div>

</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.10.0/tocbot.min.js"></script>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script>
    document.getElementById("year").innerHTML = new Date().getFullYear();
</script>

<script>
    tocbot.init( {
        tocSelector: '#article-toc',
        contentSelector: 'article',
        headingSelector: 'h1, h2, h3, h4, h5',
        collapseDepth: 3,
        positionFixedSelector: null,
        scrollSmooth: true,
        scrollSmoothDuration: 420
    } );
    var tocList = document.getElementById( 'article-toc' ).getElementsByClassName( 'toc-list' );
    if ( tocList && tocList.length > 0 && tocList[0].childNodes.length > 0 ) {
        document.getElementById( 'article-toc' ).parentNode.classList.remove( 'hidden' );
    }
</script>

 <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
  <script type="text/javascript"> docsearch({
      appId: '89ZVZ4S26W',
      apiKey: 'a797119372b8a613eb38a9564867085c',
      indexName: 'dev_DOCS',
      inputSelector: '#searchBar',
      algoliaOptions: { hitsPerPage: 10 },
    });
  </script>
  </body>
</html>
